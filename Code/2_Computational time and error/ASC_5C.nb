(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    264358,       7445]
NotebookOptionsPosition[    262393,       7411]
NotebookOutlinePosition[    262750,       7427]
CellTagsIndexPosition[    262707,       7424]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "Role", " ", "of", " ", "Adaptive", " ", "Reformulation", " ",
      "for", " ", "Improving", " ", "Electrochemical", " ", "Thermal", " ", 
     "Simulation", " ", "of", " ", "Lithium"}], "-", 
    RowBox[{"Ion", " ", "Batteries"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", "@", "2020"}], " ", "VPSL", " ", "group", " ", 
     RowBox[{"(", 
      RowBox[{"LeXu", ",", 
       RowBox[{"Email", ":", 
        RowBox[{
         RowBox[{"lexu", "@", "cqu"}], ".", "edu", ".", "cn"}]}]}], ")"}]}], 
    ",", 
    RowBox[{"Chongqing", " ", 
     RowBox[{"University", ".", "All"}], " ", "Rights", " ", 
     RowBox[{"Reserved", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Firstly", ",", 
    RowBox[{"please", " ", "set", " ", "the", " ", 
     RowBox[{"directory", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"When", " ", "you", " ", "download", " ", "the", " ", 
     RowBox[{"\[OpenCurlyQuote]", 
      RowBox[{"Electrochemical", "-", "Thermal", "-", "Simulation", "-", 
       RowBox[{"main", ".", "zip"}]}], "\[CloseCurlyQuote]"}], " ", "from", 
     " ", "github"}], ",", 
    RowBox[{
    "you", " ", "should", " ", "put", " ", "it", " ", "in", " ", "one", " ", 
     "of", " ", "your", " ", "disks", " ", "and", " ", "unzip", " ", 
     RowBox[{"it", "."}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "instance"}], ",", 
    RowBox[{
    "if", " ", "you", " ", "put", " ", "it", " ", "in", " ", "G", " ", 
     "disk"}], ",", 
    RowBox[{
    "the", " ", "directory", " ", "should", " ", "be", " ", "set", " ", "as", 
     " ", 
     RowBox[{"follows", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\<G:\\\\Electrochemical-Thermal-Simulation-main\\\\Electrochemical-\
Thermal-Simulation-main\\\\Data\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], ";"}], "\n", 
   RowBox[{"Symbolize", "[", 
    RowBox[{"ParsedBoxWrapper", "[", 
     RowBox[{"SubscriptBox", "[", 
      RowBox[{"\"\<_\>\"", ",", "\"\<_\>\""}], "]"}], "]"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"Clear", " ", "all", " ", "variables"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Import", " ", "the", " ", "reference", " ", "values"}], "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"In", " ", "this", " ", "study"}], ",", 
     RowBox[{
     "the", " ", "freely", " ", "available", " ", "LIONSIMBA", " ", "toolbox",
       " ", "is", " ", "used", " ", "as", " ", "the", " ", 
      RowBox[{"benchmark", "."}]}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "LIONSIMBA", " ", "toolbox", " ", "can", " ", "be", " ", 
      "found", " ", "in", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"github", ".", "com"}], "/", "lionsimbatoolbox"}], "/", 
      RowBox[{"LIONSIMBA", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refVt", "=", 
     RowBox[{"Import", "[", "\"\<refVt_5C.CSV\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refVt", "=", 
     RowBox[{"refVt", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}], ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simtime", "=", "218"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "discrete", " ", "nodes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["Nt", "p"], ":", " ", "Cathode"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["Nt", "s"], ":", " ", "Separator"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["Nt", "n"], ":", " ", "Anode"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["Nt", "p"], "=", "9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["Nt", "s"], "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["Nt", "n"], "=", "9"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iapp", "=", 
     RowBox[{
      RowBox[{"-", "30"}], "*", "5"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rp", "=", 
     RowBox[{"0.2", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "5"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rn", "=", 
     RowBox[{"0.2", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "5"}]}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"brugg", "=", "4"}], ";", 
    RowBox[{"De", "=", 
     RowBox[{"0.75", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";", 
    RowBox[{"Dsp", "=", 
     RowBox[{"0.1", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "13"}]}]}]}], ";", 
    RowBox[{"Dsn", "=", 
     RowBox[{"0.39", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "13"}]}]}]}], ";", 
    RowBox[{
     SubscriptBox["eps", "p"], "=", ".385"}], ";", 
    RowBox[{
     SubscriptBox["eps", "s"], "=", ".724"}], ";", 
    RowBox[{
     SubscriptBox["eps", "n"], "=", ".485"}], ";", 
    RowBox[{
     SubscriptBox["Deff", "p"], "=", 
     RowBox[{"De", "*", 
      RowBox[{
       SubscriptBox["eps", "p"], "^", "brugg"}]}]}], ";", 
    RowBox[{
     SubscriptBox["Deff", "s"], "=", 
     RowBox[{"De", "*", 
      RowBox[{
       SubscriptBox["eps", "s"], "^", "brugg"}]}]}], ";", 
    RowBox[{
     SubscriptBox["Deff", "n"], "=", 
     RowBox[{"De", "*", 
      RowBox[{
       SubscriptBox["eps", "n"], "^", "brugg"}]}]}], ";", 
    RowBox[{
     SubscriptBox["l", "p"], "=", 
     RowBox[{"0.80", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "4"}]}]}]}], ";", 
    RowBox[{
     SubscriptBox["l", "s"], "=", 
     RowBox[{"0.25", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "4"}]}]}]}], ";", 
    RowBox[{
     SubscriptBox["l", "n"], "=", 
     RowBox[{"0.88", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "4"}]}]}]}], ";", 
    RowBox[{
     SubscriptBox["epsf", "p"], "=", 
     RowBox[{"0.25", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], ";", 
    RowBox[{
     SubscriptBox["epsf", "n"], "=", 
     RowBox[{"0.326", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], ";", 
    RowBox[{"ap", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["eps", "p"], "-", 
          SubscriptBox["epsf", "p"]}], ")"}]}], ")"}], "/", "Rp"}]}], ";", 
    RowBox[{"an", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["eps", "n"], "-", 
          SubscriptBox["epsf", "n"]}], ")"}]}], ")"}], "/", "Rn"}]}], ";", 
    RowBox[{"tplus", "=", ".363"}], ";", 
    RowBox[{
     SubscriptBox["sig", "p"], "=", "100"}], ";", 
    RowBox[{
     SubscriptBox["sig", "n"], "=", "100"}], ";", 
    RowBox[{
     SubscriptBox["sigeff", "p"], "=", 
     RowBox[{
      SubscriptBox["sig", "p"], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["eps", "p"], "-", 
        SubscriptBox["epsf", "p"]}], ")"}]}]}], ";", 
    RowBox[{
     SubscriptBox["sigeff", "n"], "=", 
     RowBox[{
      SubscriptBox["sig", "n"], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["eps", "n"], "-", 
        SubscriptBox["epsf", "n"]}], ")"}]}]}], ";", 
    RowBox[{"F", "=", "96487"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["csmax", "p"], "=", "51554"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["csmax", "n"], "=", "30555"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce", "=", "1000"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["keff", "p"], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["kkeff", "p"], "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["Nt", "p"], "+", "2", "+", "1"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["keff", "s"], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["kkeff", "s"], "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["Nt", "s"], "+", "2", "+", "1"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["keff", "n"], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["kkeff", "n"], "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["Nt", "n"], "+", "2", "+", "1"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.778726676996842*^9, 3.778726945746214*^9}, {
   3.7787270009053683`*^9, 3.7787270084327993`*^9}, {3.7787270607787933`*^9, 
   3.778727284266576*^9}, {3.778794434729948*^9, 3.778794476002309*^9}, {
   3.7787951250034294`*^9, 3.778795125521459*^9}, {3.7795117505062637`*^9, 
   3.7795117545884976`*^9}, {3.7795238374005947`*^9, 3.779523840965799*^9}, {
   3.781431301292945*^9, 3.78143130365208*^9}, {3.78151429815956*^9, 
   3.781514299348628*^9}, {3.7820308400025587`*^9, 3.7820308411026216`*^9}, {
   3.7820319259886737`*^9, 3.7820319275397625`*^9}, {3.782032163968285*^9, 
   3.782032165113351*^9}, {3.7820334528200035`*^9, 3.7820334541400785`*^9}, {
   3.7820335472184024`*^9, 3.782033548852496*^9}, 3.7820336030175943`*^9, {
   3.7820337256356077`*^9, 3.7820337289937997`*^9}, {3.782039302071561*^9, 
   3.782039302841605*^9}, 3.782125082686962*^9, 3.782125994998143*^9, {
   3.7822020453275113`*^9, 3.782202046846598*^9}, {3.7822028104592743`*^9, 
   3.782202811534336*^9}, {3.782371184792143*^9, 3.782371208220483*^9}, 
   3.7893622536538744`*^9, {3.7897050590885935`*^9, 3.789705066165656*^9}, {
   3.7897051010345063`*^9, 3.7897051346287346`*^9}, {3.789705200243373*^9, 
   3.789705212917505*^9}, {3.789794552503395*^9, 3.7897945632536974`*^9}, 
   3.78979558934656*^9, {3.7897957810543942`*^9, 3.7897957830121617`*^9}, {
   3.789795863123637*^9, 3.789795865969034*^9}, {3.7897995456398344`*^9, 
   3.7897995539476595`*^9}, {3.7898008496753693`*^9, 3.7898008559615717`*^9}, 
   3.7900384754329557`*^9, 3.7900428597073464`*^9, 3.7900432246666684`*^9, 
   3.7901316703594737`*^9, 3.790131830102844*^9, 3.7901323924389505`*^9, 
   3.790134453023781*^9, {3.790137656175418*^9, 3.7901376565933266`*^9}, 
   3.790138079679251*^9, 3.7901387049901514`*^9, {3.790138787293898*^9, 
   3.7901387873447604`*^9}, {3.790217247302884*^9, 3.79021724935086*^9}, 
   3.7902180713336325`*^9, {3.790218235496975*^9, 3.7902182356729774`*^9}, 
   3.7902183195968895`*^9, {3.7902190844487114`*^9, 3.7902190870058794`*^9}, {
   3.790219215774329*^9, 3.7902192161702995`*^9}, 3.7902192929827414`*^9, 
   3.790219329675949*^9, 3.7904862154647303`*^9, {3.7904862870472803`*^9, 
   3.7904863008703146`*^9}, {3.7904877637354565`*^9, 3.79048776601239*^9}, {
   3.7904878654723377`*^9, 3.7904878655700493`*^9}, {3.7904879798240013`*^9, 
   3.7904879803286495`*^9}, 3.790488014998501*^9, {3.7904880680280294`*^9, 
   3.7904880681128035`*^9}, 3.7906538616990066`*^9, 3.79065568795622*^9, {
   3.7906559353152375`*^9, 3.7906559370643806`*^9}, {3.790657085530419*^9, 
   3.7906570873276157`*^9}, 3.790657308564684*^9, 3.7906580271893253`*^9, {
   3.790659290392211*^9, 3.790659292313672*^9}, {3.790667203798853*^9, 
   3.790667203908206*^9}, 3.790667648161775*^9, 3.790668062754305*^9, {
   3.7909119489738817`*^9, 3.7909119592513933`*^9}, {3.790913721450321*^9, 
   3.790913723438032*^9}, {3.7909158928376513`*^9, 3.790915893738246*^9}, {
   3.790917122164643*^9, 3.790917123112118*^9}, 3.7909171626162586`*^9, {
   3.790995490784181*^9, 3.79099552263605*^9}, {3.790997353150201*^9, 
   3.7909973550872445`*^9}, {3.7910877299473057`*^9, 3.7910877318843536`*^9}, 
   3.791087993476556*^9, {3.7910880939194307`*^9, 3.79108809601624*^9}, 
   3.7910882041280756`*^9, {3.79115356726466*^9, 3.791153568499365*^9}, 
   3.7911541103828325`*^9, {3.791154389531762*^9, 3.791154391625052*^9}, {
   3.791862048767501*^9, 3.7918620848839693`*^9}, {3.791862149648794*^9, 
   3.791862150164415*^9}, {3.7918623432534227`*^9, 3.79186237009865*^9}, {
   3.791862448596258*^9, 3.791862449470893*^9}, 3.7918634898434353`*^9, 
   3.7918635780890365`*^9, {3.7929725290998635`*^9, 3.79297256156094*^9}, {
   3.792974073221453*^9, 3.7929740747835865`*^9}, 3.798257717976848*^9, {
   3.7982578263949776`*^9, 3.798257827254402*^9}, {3.7982578808641777`*^9, 
   3.7982578812861023`*^9}, 3.7982579397815046`*^9, {3.798257982719371*^9, 
   3.798257982844407*^9}, {3.7982580338604083`*^9, 3.7982580370010595`*^9}, 
   3.798258089029128*^9, {3.7983404775744333`*^9, 3.7983404791345224`*^9}, {
   3.8030353721443577`*^9, 3.803035374791842*^9}, {3.803035599688078*^9, 
   3.8030356098832345`*^9}, {3.8433831864593015`*^9, 3.843383188989699*^9}, {
   3.8433862598541265`*^9, 3.8433862796767406`*^9}, {3.843387950566509*^9, 
   3.8433879719271793`*^9}, 3.8434740455751824`*^9, 3.8434740894494896`*^9, {
   3.843474136148821*^9, 3.843474140188594*^9}, 3.8435137283096275`*^9},
 CellLabel->
  "In[2898]:=",ExpressionUUID->"027b302b-87cb-4a88-9c4e-e0a877a08b14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"2", "\:3001", 
    RowBox[{
     RowBox[{"Pade", " ", "Matrix"}], "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"See", " ", "methods", " ", 
    RowBox[{"part", ":", " ", 
     RowBox[{
      RowBox[{"Pad\[EAcute]", " ", "formulation", " ", "for", " ", "solid"}], 
      "-", 
      RowBox[{"phase", " ", "diffusion", " ", 
       RowBox[{"equation", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"An", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "0.196905943204083"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "4.95238152144722"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "0.642212535348694"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bn", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1500000.00000000"}], ",", "0.0183089976636328", ",", 
       "1.19657502957323", ",", 
       RowBox[{"-", "0.214884027236866"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cn", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "54710238.2574182"}], ",", 
       RowBox[{"-", "11694328.0685018"}], ",", "7004566.32592005"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ap", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "0.0504887033856623"}], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"-", "1.26984141575570"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "0.164669880858639"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1500000.00000000"}], ",", "0.0183089976636328", ",", 
       "1.19657502957323", ",", 
       RowBox[{"-", "0.214884027236866"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cp", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "54710238.2574182"}], ",", 
       RowBox[{"-", "11694328.0685018"}], ",", "7004566.32592005"}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.789774375020843*^9, 3.78977442157994*^9}, {
  3.789774543822119*^9, 3.789774550751603*^9}, {3.7906610270306425`*^9, 
  3.790661038000518*^9}, {3.792972597193143*^9, 3.7929726059723516`*^9}, {
  3.7982570227812705`*^9, 3.798257029531325*^9}, {3.843474169538725*^9, 
  3.843474177469468*^9}},
 CellLabel->
  "In[2918]:=",ExpressionUUID->"69a31226-a7f4-407c-9ff8-638fea1358a8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"alpha", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", "=", 
     RowBox[{
      SubscriptBox["Nt", "s"], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"beta", "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"alpha", "+", "beta", "+", "2"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listg", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{".5", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "^", "2"}], "-", 
             RowBox[{"beta", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", 
                "1"}], ")"}], "^", "2"}], "-", "1"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listg", ",", 
       RowBox[{"g", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "1", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"alpha", "+", "1"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"beta", "+", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "+", "beta", "+", "2"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"alpha", "+", "beta", "+", "3"}], ")"}]}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listh", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "alpha", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "beta", "-", "1"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "alpha", "+", "beta", "-", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "1"}], 
            ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "2"}], 
             ")"}], "^", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "3"}], 
            ")"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listh", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listh", ",", 
       RowBox[{"h", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listh", ",", 
       RowBox[{"h", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lam", "=", 
     RowBox[{"RecurrenceTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"lam", "[", 
           RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"NN", "-", "i", "+", "1"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"NN", "+", "i", "+", "alpha", "+", "beta"}], ")"}], "*", 
           RowBox[{
            RowBox[{"lam", "[", 
             RowBox[{"i", "-", "1", "+", "1"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"i", "*", 
              RowBox[{"(", 
               RowBox[{"i", "+", "beta"}], ")"}]}], ")"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"lam", "[", "1", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
       "lam", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"NN", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"g", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"p", "[", "2", "]"}]}], "-", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", 
       RowBox[{"p", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "4", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"g", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"p", "[", "3", "]"}]}], "-", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"p", "[", "2", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "3"}], ",", 
      RowBox[{"i", "<=", "NN"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"i", "+", "2"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"g", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "2", "-", "1"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "2", "-", "2"}], "]"}]}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{
      RowBox[{"lam", "[", 
       RowBox[{"[", 
        RowBox[{"NN", "+", "1"}], "]"}], "]"}], "*", 
      RowBox[{"p", "[", 
       RowBox[{"NN", "+", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"P", "\[Equal]", "0"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], ",", "1"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", "=", 
     RowBox[{"Flatten", "[", "x2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"g", ",", "h", ",", "lam"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sysab", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta", "=", "sysab"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", "=", 
     RowBox[{
      SubscriptBox["Nt", "p"], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"beta", "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"alpha", "+", "beta", "+", "2"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listg", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{".5", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "^", "2"}], "-", 
             RowBox[{"beta", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", 
                "1"}], ")"}], "^", "2"}], "-", "1"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listg", ",", 
       RowBox[{"g", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "1", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"alpha", "+", "1"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"beta", "+", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "+", "beta", "+", "2"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"alpha", "+", "beta", "+", "3"}], ")"}]}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listh", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "alpha", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "beta", "-", "1"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "alpha", "+", "beta", "-", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "1"}], 
            ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "2"}], 
             ")"}], "^", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "3"}], 
            ")"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listh", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listh", ",", 
       RowBox[{"h", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listh", ",", 
       RowBox[{"h", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lam", "[", "1", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<=", "NN"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"lam", "[", 
        RowBox[{"i", "+", "1"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NN", "-", "i", "+", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"NN", "+", "i", "+", "alpha", "+", "beta"}], ")"}], "*", 
        RowBox[{
         RowBox[{"lam", "[", 
          RowBox[{"i", "-", "1", "+", "1"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"i", "*", 
           RowBox[{"(", 
            RowBox[{"i", "+", "beta"}], ")"}]}], ")"}]}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"g", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"p", "[", "2", "]"}]}], "-", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", 
       RowBox[{"p", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "4", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"g", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"p", "[", "3", "]"}]}], "-", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"p", "[", "2", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "3"}], ",", 
      RowBox[{"i", "<=", "NN"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"i", "+", "2"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"g", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "2", "-", "1"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "2", "-", "2"}], "]"}]}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{
      RowBox[{"lam", "[", 
       RowBox[{"NN", "+", "1"}], "]"}], "*", 
      RowBox[{"p", "[", 
       RowBox[{"NN", "+", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"P", "\[Equal]", "0"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], ",", "1"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{"Flatten", "[", "x1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"g", ",", "h", ",", "lam"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", "=", "sysab"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", "=", 
     RowBox[{
      SubscriptBox["Nt", "n"], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", "1", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"beta", "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"alpha", "+", "beta", "+", "2"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listg", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{".5", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"alpha", "^", "2"}], "-", 
             RowBox[{"beta", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", 
                "1"}], ")"}], "^", "2"}], "-", "1"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listg", ",", 
       RowBox[{"g", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "1", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"h", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"alpha", "+", "1"}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"beta", "+", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha", "+", "beta", "+", "2"}], ")"}], "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"alpha", "+", "beta", "+", "3"}], ")"}]}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listh", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "alpha", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"i", "+", "beta", "-", "1"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "alpha", "+", "beta", "-", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "1"}], 
            ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "2"}], 
             ")"}], "^", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "i"}], "+", "alpha", "+", "beta", "-", "3"}], 
            ")"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", "NN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listh", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listh", ",", 
       RowBox[{"h", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"listh", ",", 
       RowBox[{"h", "[", "1", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lam", "[", "1", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<=", "NN"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"lam", "[", 
        RowBox[{"i", "+", "1"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NN", "-", "i", "+", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"NN", "+", "i", "+", "alpha", "+", "beta"}], ")"}], "*", 
        RowBox[{
         RowBox[{"lam", "[", 
          RowBox[{"i", "-", "1", "+", "1"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"i", "*", 
           RowBox[{"(", 
            RowBox[{"i", "+", "beta"}], ")"}]}], ")"}]}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"g", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"p", "[", "2", "]"}]}], "-", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", 
       RowBox[{"p", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "4", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"g", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"p", "[", "3", "]"}]}], "-", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"p", "[", "2", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "3"}], ",", 
      RowBox[{"i", "<=", "NN"}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"i", "+", "2"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"g", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "2", "-", "1"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "2", "-", "2"}], "]"}]}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{
      RowBox[{"lam", "[", 
       RowBox[{"NN", "+", "1"}], "]"}], "*", 
      RowBox[{"p", "[", 
       RowBox[{"NN", "+", "2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"P", "\[Equal]", "0"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x3", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NN"}], "}"}]}], "]"}], ",", "1"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", "=", 
     RowBox[{"Flatten", "[", "x3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nt1", "=", 
     RowBox[{
      SubscriptBox["Nt", "p"], "+", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nt2", "=", 
     RowBox[{
      SubscriptBox["Nt", "s"], "+", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["N", "p"], "=", 
     RowBox[{
      SubscriptBox["Nt", "p"], "+", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["N", "s"], "=", 
     RowBox[{
      SubscriptBox["Nt", "s"], "+", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["N", "n"], "=", 
     RowBox[{
      SubscriptBox["Nt", "n"], "+", "2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c11", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            SubscriptBox["N", "p"], "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c11", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"c11", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c12", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "i"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SubscriptBox["N", "p"]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c1", "=", 
     RowBox[{"c11", "*", "c12"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"x1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["N", "p"], "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X1", "=", 
     RowBox[{"Transpose", "[", "X1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dX1", "=", 
     RowBox[{"X1", "-", 
      RowBox[{"Transpose", "[", "X1", "]"}]}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "c1", "}"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", "/", "c1"}], "}"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"dX1", "+", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          SubscriptBox["N", "p"], "+", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D1", "=", 
     RowBox[{"N", "[", 
      RowBox[{"D1", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D1", "=", 
     RowBox[{"D1", "-", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "D1", "]"}], ",", "1"}], "]"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c21", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            SubscriptBox["N", "s"], "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c21", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"c21", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c22", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "i"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SubscriptBox["N", "s"]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c2", "=", 
     RowBox[{"c21", "*", "c22"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"x2", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["N", "s"], "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X2", "=", 
     RowBox[{"Transpose", "[", "X2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dX2", "=", 
     RowBox[{"X2", "-", 
      RowBox[{"Transpose", "[", "X2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D2", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "c2", "}"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", "/", "c2"}], "}"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"dX2", "+", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          SubscriptBox["N", "s"], "+", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D2", "=", 
     RowBox[{"N", "[", 
      RowBox[{"D2", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D2", "=", 
     RowBox[{"D2", "-", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "D2", "]"}], ",", "1"}], "]"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c31", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            SubscriptBox["N", "n"], "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c31", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"c31", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c32", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", "i"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SubscriptBox["N", "n"]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c3", "=", 
     RowBox[{"c31", "*", "c32"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"x3", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["N", "n"], "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X3", "=", 
     RowBox[{"Transpose", "[", "X3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dX3", "=", 
     RowBox[{"X3", "-", 
      RowBox[{"Transpose", "[", "X3", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D3", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "c3", "}"}], "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"1", "/", "c3"}], "}"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"dX3", "+", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          SubscriptBox["N", "n"], "+", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D3", "=", 
     RowBox[{"N", "[", 
      RowBox[{"D3", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D3", "=", 
     RowBox[{"D3", "-", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "D3", "]"}], ",", "1"}], "]"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["D1", "2"], "=", 
     RowBox[{"D1", ".", "D1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["D2", "2"], "=", 
     RowBox[{"D2", ".", "D2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["D3", "2"], "=", 
     RowBox[{"D3", ".", "D3"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{"N", "[", 
      RowBox[{"x1", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", "=", 
     RowBox[{"N", "[", 
      RowBox[{"x2", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", "=", 
     RowBox[{"N", "[", 
      RowBox[{"x3", ",", "8"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7896133954803677`*^9, 3.7896134078991823`*^9}, {
   3.7896137398901196`*^9, 3.789613804618588*^9}, {3.789613860898205*^9, 
   3.7896138661840787`*^9}, {3.789613905814229*^9, 3.789613937922431*^9}, {
   3.789613972845832*^9, 3.789613973373379*^9}, {3.789614114993823*^9, 
   3.7896141817585087`*^9}, 3.789614217217374*^9, {3.789614260924576*^9, 
   3.789614278887578*^9}, {3.7896143623465567`*^9, 3.78961448635423*^9}, {
   3.789614516842183*^9, 3.7896146024354553`*^9}, {3.7896146434133434`*^9, 
   3.7896146559009733`*^9}, {3.789614723526908*^9, 3.7896147402671337`*^9}, {
   3.789614774955453*^9, 3.789614796723285*^9}, {3.7896149284227858`*^9, 
   3.7896149403319874`*^9}, {3.7897018256093116`*^9, 
   3.7897018742373705`*^9}, {3.7897019662903814`*^9, 3.789702021827978*^9}, {
   3.78970234311643*^9, 3.789702364292843*^9}, {3.78970245247423*^9, 
   3.78970254220146*^9}, 3.7897025748152847`*^9, {3.7897026501719413`*^9, 
   3.7897026511812196`*^9}, {3.789702685139494*^9, 3.7897027451750736`*^9}, {
   3.7897028133578763`*^9, 3.789702873762434*^9}, {3.7897029041113644`*^9, 
   3.7897029152366066`*^9}, {3.7897029841815767`*^9, 
   3.7897031445829525`*^9}, {3.789703266150591*^9, 3.789703324551529*^9}, {
   3.78970336853255*^9, 3.789703482533704*^9}, {3.789703531274331*^9, 
   3.7897036029001303`*^9}, {3.7897036957388525`*^9, 
   3.7897037614399104`*^9}, {3.7897038093413353`*^9, 
   3.7897038249226723`*^9}, {3.7897038618849273`*^9, 3.789703894903694*^9}, {
   3.7897042540516706`*^9, 3.7897043619194555`*^9}, {3.7897044453953915`*^9, 
   3.7897044620149546`*^9}, {3.789704493701282*^9, 3.7897045622950125`*^9}, {
   3.789704609280778*^9, 3.789704794795022*^9}, {3.789704843937728*^9, 
   3.789704878196156*^9}, {3.7897049177293377`*^9, 3.7897049960866795`*^9}, {
   3.789705149712428*^9, 3.78970515308342*^9}, {3.789705258724099*^9, 
   3.7897052857080207`*^9}, {3.790641050128165*^9, 3.7906410994576054`*^9}, 
   3.790641209623949*^9, 3.7906413170786905`*^9, {3.8433878936794224`*^9, 
   3.8433879385919523`*^9}, {3.8435137411231794`*^9, 3.8435137456928263`*^9}},
 CellLabel->
  "In[2924]:=",ExpressionUUID->"889742f7-ba98-4d77-9b0b-a5f3a41feb3a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"u10", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1000", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u20", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1000", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u30", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1000", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u4", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu41", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu42", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu43", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu44", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u5", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu51", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu52", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu53", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vu54", "[", "i", "]"}], "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z6", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z7", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cs", "/", "csmax"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["theta", "p"], "=", 
     RowBox[{"z1", "/", 
      SubscriptBox["csmax", "p"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["theta", "n"], "=", 
     RowBox[{"z2", "/", 
      SubscriptBox["csmax", "n"]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"num", "=", 
     RowBox[{
      RowBox[{"-", "4.656"}], "+", 
      RowBox[{"88.669", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "2"}]}], "-", 
      RowBox[{"401.119", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "4"}]}], "+", 
      RowBox[{"342.909", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "6"}]}], "-", 
      RowBox[{"462.471", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "8"}]}], "+", 
      RowBox[{"433.434", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "10"}]}]}]}], ";", 
    RowBox[{"den", "=", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"18.933", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "2"}]}], "-", 
      RowBox[{"79.532", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "4"}]}], "+", 
      RowBox[{"37.311", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "6"}]}], "-", 
      RowBox[{"73.083", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "8"}]}], "+", 
      RowBox[{"95.96", "*", 
       RowBox[{
        SubscriptBox["theta", "p"], "^", "10"}]}]}]}], ";", 
    RowBox[{"fUp", "=", 
     RowBox[{"num", "/", "den"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fUn", "=", 
     RowBox[{".7222", "+", 
      RowBox[{".1387", "*", 
       SubscriptBox["theta", "n"]}], "+", 
      RowBox[{"0.029", "*", 
       RowBox[{
        SubscriptBox["theta", "n"], "^", ".5"}]}], "-", 
      RowBox[{"0.0172", "/", 
       SubscriptBox["theta", "n"]}], "+", 
      RowBox[{"0.0019", "/", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["theta", "n"], "^", "1.5"}], ")"}]}], "+", 
      RowBox[{".2808", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{".9", "-", 
         RowBox[{"15", "*", 
          SubscriptBox["theta", "n"]}]}], "]"}]}], "-", 
      RowBox[{".7984", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{".4465", "*", 
          SubscriptBox["theta", "n"]}], "-", ".4108"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7897067340261517`*^9, 3.7897067962568593`*^9}, {
   3.789707969125807*^9, 3.7897080038470206`*^9}, {3.789708039074884*^9, 
   3.7897080391347256`*^9}, {3.789708107672577*^9, 3.7897082365581694`*^9}, {
   3.789709412157237*^9, 3.789709424394566*^9}, 3.7897102433152447`*^9, {
   3.7897744871377563`*^9, 3.789774508088773*^9}, {3.789774602171199*^9, 
   3.789774689379163*^9}, {3.7897756839032354`*^9, 3.7897756864683795`*^9}, {
   3.7897760598831835`*^9, 3.7897760904654617`*^9}, {3.789776367920019*^9, 
   3.789776380864432*^9}, {3.789796632395274*^9, 3.789796694334758*^9}, {
   3.7897968697332497`*^9, 3.7897968996164246`*^9}, {3.789797072937258*^9, 
   3.7897971029660425`*^9}, {3.7897996238209147`*^9, 
   3.7897996845586405`*^9}, {3.78979974214872*^9, 3.7897997509242725`*^9}, {
   3.789799887699018*^9, 3.789799888103965*^9}, {3.789960789192646*^9, 
   3.7899608038724194`*^9}, 3.7901321857693715`*^9, {3.7901379536544976`*^9, 
   3.790137956303419*^9}, {3.790661068932419*^9, 3.790661091582615*^9}, {
   3.7929726450731077`*^9, 3.7929726552269945`*^9}, {3.7982570454689875`*^9, 
   3.7982570576877966`*^9}, {3.843513831545103*^9, 3.8435138425411024`*^9}},
 CellLabel->
  "In[3033]:=",ExpressionUUID->"bc0842f9-5137-423c-b5fe-fc5d9faf653b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kp", "=", 
     RowBox[{"0.2334", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "10"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kn", "=", 
     RowBox[{"0.5031", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "10"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", "8.314"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", "298.15"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{3.790137920053695*^9, 3.8435138450473566`*^9},
 CellLabel->
  "In[3052]:=",ExpressionUUID->"835397eb-71fb-41ea-a128-68be5ad0ddb1"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "=", "500000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tini", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mu", "=", "0.00001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TH", "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Tanh", "[", 
         RowBox[{"q", "*", 
          RowBox[{"(", 
           RowBox[{"t", "-", "tini"}], ")"}]}], "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.789800300277647*^9, {3.7900428646287003`*^9, 3.7900428647686996`*^9}, 
   3.7929744438089685`*^9, {3.7929744832622004`*^9, 3.792974485839983*^9}, {
   3.7929745233251915`*^9, 3.7929745240437737`*^9}, 3.7929748499998617`*^9, 
   3.798258161576668*^9, {3.7982582066707315`*^9, 3.7982582067801723`*^9}, 
   3.798340628726079*^9, {3.7983406658542023`*^9, 3.7983406970139847`*^9}, 
   3.80303540093886*^9, 3.8435138469357805`*^9},
 CellLabel->
  "In[3056]:=",ExpressionUUID->"9721a7cf-3680-41dc-8536-7385d55890ca"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "p"]}], "/", 
            SubscriptBox["l", "p"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "ff1", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "p"]}], "/", 
            SubscriptBox["l", "p"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt1"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"u1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt1"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u11", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "s"]}], "/", 
            SubscriptBox["l", "s"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "s"]}], "/", 
            SubscriptBox["l", "s"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt2", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "ff1", "}"}], ",", 
        RowBox[{"{", "ff2", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "s"]}], "/", 
            SubscriptBox["l", "s"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "s"]}], "/", 
            SubscriptBox["l", "s"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt2", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt2"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"u2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt2"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u21", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "n"]}], "/", 
            SubscriptBox["l", "n"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
       RowBox[{"D3", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "ff2", "}"}], ",", 
        RowBox[{"{", "0", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Deff", "n"]}], "/", 
            SubscriptBox["l", "n"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
       RowBox[{"D3", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt1"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"u3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt1"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u31", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u3end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7897053292476482`*^9, 3.7897053874630857`*^9}, {
   3.7897054507544656`*^9, 3.789705596378621*^9}, {3.7897056293235846`*^9, 
   3.7897056314638653`*^9}, {3.789705730820768*^9, 3.7897057309673758`*^9}, {
   3.7897058657688074`*^9, 3.7897058845735636`*^9}, {3.7897059848084707`*^9, 
   3.789706003469604*^9}, {3.7897060534361124`*^9, 3.789706183562389*^9}, {
   3.7897062394899397`*^9, 3.789706274227086*^9}, 3.789706307907208*^9, {
   3.789706368454384*^9, 3.78970656663583*^9}, {3.789706598084443*^9, 
   3.7897066445781755`*^9}, {3.7897066770444183`*^9, 3.789706685095936*^9}, {
   3.7897068042345695`*^9, 3.7897069159251103`*^9}, {3.7897069546166887`*^9, 
   3.789706962412857*^9}, {3.7897070305784683`*^9, 3.7897070537525425`*^9}, {
   3.789707131084895*^9, 3.7897075941534843`*^9}, {3.789707624967143*^9, 
   3.7897076326277018`*^9}, 3.7897077701900787`*^9, {3.7897744494405003`*^9, 
   3.7897744554623995`*^9}, {3.7897756967010107`*^9, 
   3.7897756984702806`*^9}, {3.7910856269273267`*^9, 3.791085631722757*^9}, {
   3.843513849664896*^9, 3.843513854367259*^9}},
 CellLabel->
  "In[3060]:=",ExpressionUUID->"f1794da6-d8b9-448f-aa37-a304fd2ae79d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fun1", "=", 
   RowBox[{
    RowBox[{"u1end", "-", "u21"}], "\[Equal]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun2", "=", 
   RowBox[{
    RowBox[{"u2end", "-", "u31"}], "\[Equal]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{"ff1", ",", "ff2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fun1", ",", "fun2"}], "}"}], ",", "var"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff1", "=", 
   RowBox[{"sol", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff2", "=", 
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["subkeff", "p"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["eps", "p"], "^", "brugg"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0.41253", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "1"}]}]}], "+", 
      RowBox[{"0.5007", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "3"}]}], "*", "u1"}], "-", 
      RowBox[{"0.47212", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}], "*", 
       RowBox[{"u1", "^", "2"}]}], "+", 
      RowBox[{"0.15094", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}], "*", 
       RowBox[{"u1", "^", "3"}]}], "-", 
      RowBox[{"0.16018", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "13"}]}], "*", 
       RowBox[{"u1", "^", "4"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["subkeff", "s"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["eps", "s"], "^", "brugg"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0.41253", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "1"}]}]}], "+", 
      RowBox[{"0.5007", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "3"}]}], "*", "u2"}], "-", 
      RowBox[{"0.47212", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}], "*", 
       RowBox[{"u2", "^", "2"}]}], "+", 
      RowBox[{"0.15094", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}], "*", 
       RowBox[{"u2", "^", "3"}]}], "-", 
      RowBox[{"0.16018", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "13"}]}], "*", 
       RowBox[{"u2", "^", "4"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["subkeff", "n"], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["eps", "n"], "^", "brugg"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0.41253", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "1"}]}]}], "+", 
      RowBox[{"0.5007", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "3"}]}], "*", "u3"}], "-", 
      RowBox[{"0.47212", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}], "*", 
       RowBox[{"u3", "^", "2"}]}], "+", 
      RowBox[{"0.15094", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}], "*", 
       RowBox[{"u3", "^", "3"}]}], "-", 
      RowBox[{"0.16018", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "13"}]}], "*", 
       RowBox[{"u3", "^", "4"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789707735403036*^9, 3.7897078330643854`*^9}, {
   3.7897082829541903`*^9, 3.7897083303565254`*^9}, {3.789708368348998*^9, 
   3.7897085243999987`*^9}, {3.789708626647772*^9, 3.7897089091579514`*^9}, {
   3.7897089469265037`*^9, 3.789708951950079*^9}, {3.789709001287241*^9, 
   3.7897092539736195`*^9}, {3.789709306753898*^9, 3.789709369763522*^9}, 
   3.789709429528846*^9, {3.7897094802014093`*^9, 3.7897098893720527`*^9}, {
   3.789710286111884*^9, 3.789710294688965*^9}, {3.7897103364244385`*^9, 
   3.7897104314953623`*^9}, 3.789710534152072*^9, {3.789710697296091*^9, 
   3.7897107340888004`*^9}, {3.7897107989395733`*^9, 
   3.7897108050871477`*^9}, {3.7897110118320494`*^9, 3.789711030567983*^9}, {
   3.7897120991696405`*^9, 3.78971210600637*^9}, {3.7897757170705767`*^9, 
   3.7897757465886984`*^9}, {3.7897757836566467`*^9, 3.789775793320827*^9}, {
   3.789775825629768*^9, 3.7897758713944464`*^9}, {3.7897759275752573`*^9, 
   3.789775942981089*^9}, {3.7897759797652464`*^9, 3.7897759911149178`*^9}, {
   3.7897761417564015`*^9, 3.7897764209144073`*^9}, {3.7897764811145687`*^9, 
   3.789776760740324*^9}, {3.7897768015133986`*^9, 3.7897768397631874`*^9}, {
   3.7897769249535136`*^9, 3.7897770001196547`*^9}, {3.7897967345981665`*^9, 
   3.789796743755696*^9}, {3.789796851333418*^9, 3.789796852798503*^9}, {
   3.78979712585884*^9, 3.7897971264851665`*^9}, {3.789797760805911*^9, 
   3.789797762439546*^9}, {3.789797946032312*^9, 3.789797950827527*^9}, {
   3.789798531552826*^9, 3.7897985426701183`*^9}, {3.789799049482339*^9, 
   3.7897990498264465`*^9}, {3.789799404110485*^9, 3.7897994045303297`*^9}, {
   3.789799501510165*^9, 3.789799505827626*^9}, {3.7898004245346313`*^9, 
   3.789800452821044*^9}, {3.789960760644902*^9, 3.7899607808170276`*^9}, {
   3.7899608363456435`*^9, 3.7899608844879975`*^9}, {3.7900381512112985`*^9, 
   3.7900381838129807`*^9}, 3.7900382507114305`*^9, {3.7900383189340534`*^9, 
   3.7900384253995647`*^9}, {3.790130759827041*^9, 3.790130774447464*^9}, {
   3.7901313459754915`*^9, 3.7901314099860315`*^9}, {3.79013149457465*^9, 
   3.790131495761847*^9}, {3.7901316419748697`*^9, 3.7901316465675488`*^9}, {
   3.7901317438969636`*^9, 3.790131749521311*^9}, {3.7901317879872756`*^9, 
   3.790131797735002*^9}, {3.790131942059844*^9, 3.7901319621332684`*^9}, 
   3.7901319978748817`*^9, {3.790132036928279*^9, 3.790132052643368*^9}, {
   3.790132087104457*^9, 3.790132133390541*^9}, {3.7901322197841315`*^9, 
   3.7901322785673056`*^9}, {3.7901343601322966`*^9, 3.790134421368018*^9}, 
   3.7901351643056383`*^9, {3.7901351945642433`*^9, 3.790135201953145*^9}, {
   3.790135247337186*^9, 3.7901352573036175`*^9}, {3.7901365793334737`*^9, 
   3.790136620379815*^9}, {3.790136817103724*^9, 3.7901368640433207`*^9}, {
   3.790136975341017*^9, 3.7901369914978695`*^9}, {3.790137107580134*^9, 
   3.7901371161053514`*^9}, {3.7901372092210517`*^9, 
   3.7901372241890583`*^9}, {3.7901379668222847`*^9, 3.790137967703955*^9}, 
   3.7901380495617313`*^9, {3.7901380997187023`*^9, 3.7901381898506002`*^9}, {
   3.790138222069504*^9, 3.7901383134034433`*^9}, 3.7906538489939013`*^9, {
   3.7909958775180783`*^9, 3.7909958878282304`*^9}, {3.7910856173042955`*^9, 
   3.791085625287142*^9}},
 CellLabel->
  "In[3075]:=",ExpressionUUID->"2a73444e-84ac-4f82-9ab3-d7c439abee3a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
       RowBox[{"D1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "iapp"}], "*", 
          RowBox[{
           SubscriptBox["l", "p"], "/", 
           SubscriptBox["sigeff", "p"]}]}], "}"}], ",", 
        RowBox[{"{", "0", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
       RowBox[{"D1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt1"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"z3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt1"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z31", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z3end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
       RowBox[{"D3", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "iapp"}], "*", 
          RowBox[{
           SubscriptBox["l", "n"], "/", 
           SubscriptBox["sigeff", "n"]}]}], "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", 
       RowBox[{"D3", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt1"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"z4", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt1"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z41", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z4end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7910862507625537`*^9, 3.7910862584169993`*^9}, 
   3.8435138577770452`*^9},
 CellLabel->
  "In[3084]:=",ExpressionUUID->"3550f974-7a27-4bfd-8203-f364723fc6f5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"f1", ",", "f2"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", 
               RowBox[{"Nt1", "+", "1"}], "]"}], "]"}]}], "/", 
            SubscriptBox["l", "p"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "f1", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", 
               RowBox[{"Nt1", "+", "1"}], "]"}], "]"}]}], "/", 
            SubscriptBox["l", "p"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt1"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"z5", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt1"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z51", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z5end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "/", 
            SubscriptBox["l", "s"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", 
               RowBox[{"Nt2", "+", "1"}], "]"}], "]"}]}], "/", 
            SubscriptBox["l", "s"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt2", "+", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "]"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "f1", "}"}], ",", 
        RowBox[{"{", "f2", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "/", 
            SubscriptBox["l", "s"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", 
               RowBox[{"Nt2", "+", "1"}], "]"}], "]"}]}], "/", 
            SubscriptBox["l", "s"]}]}], "}"}]}], "}"}], ".", 
       RowBox[{"D2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt2", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt2"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"z6", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt2"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z61", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z6end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa1", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "+", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               SubscriptBox["keff", "n"], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "/", 
             SubscriptBox["l", "n"]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ".", 
        RowBox[{"D3", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "f2", "}"}], ",", 
        RowBox[{"{", "0", "}"}]}], "}"}], "-", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "/", 
            SubscriptBox["l", "n"]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ".", 
       RowBox[{"D3", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Nt1", "+", "1"}]}], "}"}], ",", 
          RowBox[{"2", ";;", "Nt1"}]}], "]"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"z7", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", "Nt1"}], "]"}], "]"}], "}"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "aa1", "]"}], ".", "aa2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z71", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z7end", "=", 
     RowBox[{"aa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fun1", "=", 
     RowBox[{
      RowBox[{"z5end", "-", "z61"}], "\[Equal]", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fun2", "=", 
     RowBox[{
      RowBox[{"z6end", "-", "z71"}], "\[Equal]", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"var", "=", 
     RowBox[{"{", 
      RowBox[{"f1", ",", "f2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fun1", ",", "fun2"}], "}"}], ",", "var"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f1", "=", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f2", "=", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jjp", "=", 
     RowBox[{"2", "*", "kp", "*", 
      RowBox[{"u1", "^", "0.5"}], "*", 
      RowBox[{"z1", "^", "0.5"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["csmax", "p"], "-", "z1"}], ")"}], "^", "0.5"}], "*", 
      RowBox[{"Sinh", "[", 
       RowBox[{".5", "*", "F", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z3", "-", "z5", "-", "fUp"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"R", "*", "T"}], ")"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jjn", "=", 
     RowBox[{"2", "*", "kn", "*", 
      RowBox[{"u3", "^", "0.5"}], "*", 
      RowBox[{"z2", "^", "0.5"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["csmax", "n"], "-", "z2"}], ")"}], "^", "0.5"}], "*", 
      RowBox[{"Sinh", "[", 
       RowBox[{".5", "*", "F", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z4", "-", "z7", "-", "fUn"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"R", "*", "T"}], ")"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.790654139081881*^9, 3.7906542462482758`*^9}, {
   3.7906543724942245`*^9, 3.7906543835182524`*^9}, {3.790654414096336*^9, 
   3.7906544238889627`*^9}, {3.7906544698674097`*^9, 3.790654497279392*^9}, 
   3.7910866332161283`*^9, {3.84351386039758*^9, 3.84351386417855*^9}},
 CellLabel->
  "In[3094]:=",ExpressionUUID->"5cc7872b-f089-489a-bb5c-b28351d612b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"du1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["Deff", "p"], "/", 
        RowBox[{
         SubscriptBox["l", "p"], "^", "2"}]}], "*", 
       RowBox[{
        SubscriptBox["D1", "2"], ".", "u1"}]}], "+", 
      RowBox[{"ap", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "tplus"}], ")"}], "*", "jjp"}]}], ")"}], "/", 
    SubscriptBox["eps", "p"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["Deff", "s"], "/", 
       RowBox[{
        SubscriptBox["l", "s"], "^", "2"}]}], "*", 
      RowBox[{
       SubscriptBox["D2", "2"], ".", "u2"}]}], ")"}], "/", 
    SubscriptBox["eps", "s"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du3", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Deff", "n"], "/", 
         RowBox[{
          SubscriptBox["l", "n"], "^", "2"}]}], "*", 
        RowBox[{
         SubscriptBox["D3", "2"], ".", "u3"}]}], "+", 
       RowBox[{"an", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "tplus"}], ")"}], "*", "jjn"}]}], ")"}], "/", 
     SubscriptBox["eps", "n"]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"u11", ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du1", "[", 
    RowBox[{"[", 
     RowBox[{"Nt1", "+", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"u1end", ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fodelhs1", "=", 
   RowBox[{"D", "[", 
    RowBox[{"u1", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode1", "=", 
    RowBox[{"Flatten", "[", "fode1", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du2", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"u21", ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du2", "[", 
    RowBox[{"[", 
     RowBox[{"Nt2", "+", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"u2end", ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fodelhs2", "=", 
   RowBox[{"D", "[", 
    RowBox[{"u2", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode2", "=", 
    RowBox[{"Flatten", "[", "fode2", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du3", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"u31", ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du3", "[", 
    RowBox[{"[", 
     RowBox[{"Nt1", "+", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"u3end", ",", "t"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fodelhs3", "=", 
   RowBox[{"D", "[", 
    RowBox[{"u3", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs3", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du3", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode3", "=", 
    RowBox[{"Flatten", "[", "fode3", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode1", "=", 
   RowBox[{"fode1", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode1", "=", 
   RowBox[{"fode1", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode1", "=", 
   RowBox[{"fode1", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "n"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "n"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode1", "=", 
   RowBox[{"fode1", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["keff", "p"], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode1", "=", 
   RowBox[{"fode1", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["keff", "s"], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode1", "=", 
    RowBox[{"fode1", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["keff", "n"], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
          "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode2", "=", 
   RowBox[{"fode2", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode2", "=", 
   RowBox[{"fode2", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode2", "=", 
   RowBox[{"fode2", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "n"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "n"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode2", "=", 
   RowBox[{"fode2", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["keff", "p"], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode2", "=", 
   RowBox[{"fode2", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["keff", "s"], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode2", "=", 
    RowBox[{"fode2", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["keff", "n"], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
          "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode3", "=", 
   RowBox[{"fode3", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode3", "=", 
   RowBox[{"fode3", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode3", "=", 
   RowBox[{"fode3", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "n"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "n"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode3", "=", 
   RowBox[{"fode3", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["keff", "p"], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode3", "=", 
   RowBox[{"fode3", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["keff", "s"], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode3", "=", 
    RowBox[{"fode3", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["keff", "n"], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
          "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du41", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
     RowBox[{"Ap", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
    RowBox[{"jjp", "*", 
     RowBox[{"Bp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du42", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
     RowBox[{"Ap", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
    RowBox[{"jjp", "*", 
     RowBox[{"Bp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du43", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u4", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
     RowBox[{"Ap", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
    RowBox[{"jjp", "*", 
     RowBox[{"Bp", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du44", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"u4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{"1", ";;", 
          RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
      RowBox[{"Ap", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "+", 
     RowBox[{"jjp", "*", 
      RowBox[{"Bp", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du51", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u5", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
     RowBox[{"An", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
    RowBox[{"jjn", "*", 
     RowBox[{"Bn", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du52", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u5", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
     RowBox[{"An", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
    RowBox[{"jjn", "*", 
     RowBox[{"Bn", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"du53", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u5", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
     RowBox[{"An", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "+", 
    RowBox[{"jjn", "*", 
     RowBox[{"Bn", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"du54", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"u5", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{"1", ";;", 
          RowBox[{"Nt1", "+", "1"}]}]}], "]"}], "]"}], "*", 
      RowBox[{"An", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "+", 
     RowBox[{"jjn", "*", 
      RowBox[{"Bn", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fodelhs4", "=", 
   RowBox[{"D", "[", 
    RowBox[{"u4", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode41", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs4", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du41", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode42", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs4", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du42", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode43", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs4", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "i"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du43", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode44", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fodelhs4", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "i"}], "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"du44", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode4", "=", 
   RowBox[{"{", 
    RowBox[{"fode41", ",", "fode42", ",", "fode43", ",", "fode44"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode4", "=", 
    RowBox[{"Flatten", "[", "fode4", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode4", "=", 
   RowBox[{"fode4", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode4", "=", 
   RowBox[{"fode4", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode4", "=", 
    RowBox[{"fode4", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["keff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           SubscriptBox["subkeff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fodelhs5", "=", 
   RowBox[{"D", "[", 
    RowBox[{"u5", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode51", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs5", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du51", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode52", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs5", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du52", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode53", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fodelhs5", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "i"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"du53", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode54", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"fodelhs5", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "i"}], "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"du54", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", "TH"}]}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode5", "=", 
   RowBox[{"{", 
    RowBox[{"fode51", ",", "fode52", ",", "fode53", ",", "fode54"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode5", "=", 
    RowBox[{"Flatten", "[", "fode5", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode5", "=", 
   RowBox[{"fode5", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fode5", "=", 
   RowBox[{"fode5", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fode5", "=", 
    RowBox[{"fode5", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["keff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           SubscriptBox["subkeff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"z1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"u4", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cp", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"u4", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cp", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"u4", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cp", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"u4", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cp", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"z2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"u5", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cn", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"u5", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cn", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"u5", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cn", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"u5", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "i"}], "]"}], "]"}], "*", 
          RowBox[{"Cn", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fae3", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["sigeff", "p"], "*", 
     RowBox[{
      RowBox[{
       SubscriptBox["D1", "2"], ".", "z3"}], "/", 
      RowBox[{
       SubscriptBox["l", "p"], "^", "2"}]}]}], "-", 
    RowBox[{"(", 
     RowBox[{"ap", "*", "F", "*", "jjp"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fae4", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["sigeff", "n"], "*", 
     RowBox[{
      RowBox[{
       SubscriptBox["D3", "2"], ".", "z4"}], "/", 
      RowBox[{
       SubscriptBox["l", "n"], "^", "2"}]}]}], "-", 
    RowBox[{"(", 
     RowBox[{"an", "*", "F", "*", "jjn"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fae5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sigeff", "p"]}], "/", 
      SubscriptBox["l", "p"]}], "*", 
     RowBox[{"D1", ".", "z3"}]}], "-", 
    RowBox[{
     RowBox[{
      SubscriptBox["keff", "p"], "/", 
      SubscriptBox["l", "p"]}], "*", 
     RowBox[{"D1", ".", "z5"}]}], "+", 
    RowBox[{"2", "*", 
     SubscriptBox["keff", "p"], "*", "R", "*", 
     RowBox[{"T", "/", "F"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "tplus"}], ")"}], "/", 
      SubscriptBox["l", "p"]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"D1", ".", "u1"}], ")"}], "/", "u1"}]}], "-", "iapp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fae6", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["keff", "s"]}], "/", 
      SubscriptBox["l", "s"]}], "*", 
     RowBox[{"D2", ".", "z6"}]}], "+", 
    RowBox[{"2", "*", 
     SubscriptBox["keff", "s"], "*", "R", "*", 
     RowBox[{"T", "/", "F"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "tplus"}], ")"}], "/", 
      SubscriptBox["l", "s"]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"D2", ".", "u2"}], ")"}], "/", "u2"}]}], "-", "iapp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae7", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["sigeff", "n"]}], "/", 
       SubscriptBox["l", "n"]}], "*", 
      RowBox[{"D3", ".", "z4"}]}], "-", 
     RowBox[{
      RowBox[{
       SubscriptBox["keff", "n"], "/", 
       SubscriptBox["l", "n"]}], "*", 
      RowBox[{"D3", ".", "z7"}]}], "+", 
     RowBox[{"2", "*", 
      SubscriptBox["keff", "n"], "*", "R", "*", 
      RowBox[{"T", "/", "F"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "tplus"}], ")"}], "/", 
       SubscriptBox["l", "n"]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D3", ".", "u3"}], ")"}], "/", "u3"}]}], "-", "iapp"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae3", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz3", "[", "1", "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z31", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae3", "[", 
    RowBox[{"[", 
     RowBox[{"Nt1", "+", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz3", "[", 
      RowBox[{"Nt1", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z3end", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae4", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz4", "[", "1", "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z41", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fae4", "[", 
     RowBox[{"[", 
      RowBox[{"Nt1", "+", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"vz4", "[", 
       RowBox[{"Nt1", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
     RowBox[{"z4end", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae5", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz5", "[", "1", "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z51", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae5", "[", 
    RowBox[{"[", 
     RowBox[{"Nt1", "+", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz5", "[", 
      RowBox[{"Nt1", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z5end", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae6", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz6", "[", "1", "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z61", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae6", "[", 
    RowBox[{"[", 
     RowBox[{"Nt2", "+", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz6", "[", 
      RowBox[{"Nt2", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z6end", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fae7", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"vz7", "[", "1", "]"}], "[", "t", "]"}], "-", 
    RowBox[{"z71", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fae7", "[", 
     RowBox[{"[", 
      RowBox[{"Nt1", "+", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"vz7", "[", 
       RowBox[{"Nt1", "+", "1"}], "]"}], "[", "t", "]"}], "-", 
     RowBox[{"z7end", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfae1", "=", 
   RowBox[{"mu", "*", 
    RowBox[{"D", "[", 
     RowBox[{"fae1", ",", "t"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfae2", "=", 
   RowBox[{"mu", "*", 
    RowBox[{"D", "[", 
     RowBox[{"fae2", ",", "t"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dfae3", "=", 
    RowBox[{"mu", "*", 
     RowBox[{"D", "[", 
      RowBox[{"fae3", ",", "t"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dfae4", "=", 
    RowBox[{"mu", "*", 
     RowBox[{"D", "[", 
      RowBox[{"fae4", ",", "t"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dfae5", "=", 
    RowBox[{"mu", "*", 
     RowBox[{"D", "[", 
      RowBox[{"fae5", ",", "t"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dfae6", "=", 
    RowBox[{"mu", "*", 
     RowBox[{"D", "[", 
      RowBox[{"fae6", ",", "t"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dfae7", "=", 
    RowBox[{"mu", "*", 
     RowBox[{"D", "[", 
      RowBox[{"fae7", ",", "t"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["thamax", "p"], "=", ".4955"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["thamax", "n"], "=", ".85510"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["thamin", "p"], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["thamin", "n"], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soc", "=", "0.99999"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["csave", "p"], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"soc", "*", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["thamax", "p"], "-", 
         SubscriptBox["thamin", "p"]}], ")"}]}], "+", 
      SubscriptBox["thamin", "p"]}], ")"}], "*", 
    SubscriptBox["csmax", "p"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["csave", "n"], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"soc", "*", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["thamax", "n"], "-", 
          SubscriptBox["thamin", "n"]}], ")"}]}], "+", 
       SubscriptBox["thamin", "n"]}], ")"}], "*", 
     SubscriptBox["csmax", "n"]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming1", "=", 
    RowBox[{
    "Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu41", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du41", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu42", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du42", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu43", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du43", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu44", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du44", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "4"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0.01"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.15"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.05"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.001"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu41", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu42", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu43", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae1", "=", 
       RowBox[{"dfae1", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu44", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming2", "=", 
    RowBox[{"Timing", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu51", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du51", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu52", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du52", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu53", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du53", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu54", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du54", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "4"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0.01"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.15"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.05"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.001"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu51", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu52", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu53", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae2", "=", 
       RowBox[{"dfae2", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu54", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming3", "=", 
    RowBox[{"Timing", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu1", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu2", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt2"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu3", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du3", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "p"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "s"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "n"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "4"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0.01"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.15"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.05"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae3", "=", 
       RowBox[{"dfae3", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.001"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming4", "=", 
    RowBox[{"Timing", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu1", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu2", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt2"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu3", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du3", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "p"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "s"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "n"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "4"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0.01"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.15"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.05"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae4", "=", 
       RowBox[{"dfae4", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.001"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming5", "=", 
    RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "p"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "s"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "n"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu1", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu2", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt2"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu3", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du3", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "4"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0.01"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.15"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.05"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae5", "=", 
       RowBox[{"dfae5", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.001"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming6", "=", 
    RowBox[{
    "Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "p"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "s"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "n"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vu1", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
              "\[Rule]", 
              RowBox[{"du1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vu2", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
              "\[Rule]", 
              RowBox[{"du2", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "Nt2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vu3", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
              "\[Rule]", 
              RowBox[{"du3", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}]}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              "1000"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              "1000"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              "1000"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae6", "=", 
       RowBox[{"dfae6", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              SubscriptBox["csave", "p"]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              SubscriptBox["csave", "n"]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              "4"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              "0.01"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              RowBox[{"-", "0.15"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              RowBox[{"-", "0.05"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
              RowBox[{"-", "0.001"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], "}"}], 
         "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subtiming7", "=", 
    RowBox[{"Timing", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "p"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "s"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["keff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{
              SubscriptBox["subkeff", "n"], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "p"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "s"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["keff", "n"], "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
             "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu1", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu2", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt2"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vu3", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Rule]", 
             RowBox[{"du3", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "Nt1"}], "}"}]}], "]"}], "}"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "1000"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz1", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "p"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz2", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             SubscriptBox["csave", "n"]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "4"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             "0.01"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.15"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.05"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dfae7", "=", 
       RowBox[{"dfae7", "/.", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], "\[Rule]", 
             RowBox[{"-", "0.001"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dfae1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"fae1", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dfae2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
      RowBox[{"-", 
       RowBox[{"fae2", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae3", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dfae3", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
       RowBox[{"-", 
        RowBox[{"fae3", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae4", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dfae4", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
       RowBox[{"-", 
        RowBox[{"fae4", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae5", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dfae5", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
       RowBox[{"-", 
        RowBox[{"fae5", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae5", "=", 
   RowBox[{"ae5", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae5", "=", 
   RowBox[{"ae5", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae5", "=", 
    RowBox[{"ae5", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["keff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           SubscriptBox["subkeff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae6", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dfae6", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
       RowBox[{"-", 
        RowBox[{"fae6", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae6", "=", 
   RowBox[{"ae6", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae6", "=", 
   RowBox[{"ae6", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae6", "=", 
    RowBox[{"ae6", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["keff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           SubscriptBox["subkeff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae7", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dfae7", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
       RowBox[{"-", 
        RowBox[{"fae7", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae7", "=", 
   RowBox[{"ae7", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "p"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ae7", "=", 
   RowBox[{"ae7", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["keff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          SubscriptBox["subkeff", "s"], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ae7", "=", 
    RowBox[{"ae7", "/.", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["keff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           SubscriptBox["subkeff", "n"], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], "}"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AE", "=", 
   RowBox[{"{", 
    RowBox[{
    "ae1", ",", "ae2", ",", "ae3", ",", "ae4", ",", "ae5", ",", "ae6", ",", 
     "ae7"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AE", "=", 
   RowBox[{"Flatten", "[", "AE", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"fode1", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"fode2", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"fode3", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"fode4", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", "*", 
        RowBox[{"(", 
         RowBox[{"Nt1", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ODE5", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"fode5", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"4", "*", 
         RowBox[{"(", 
          RowBox[{"Nt1", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE", "=", 
   RowBox[{"{", 
    RowBox[{"ODE1", ",", "ODE2", ",", "ODE3", ",", "ODE4", ",", "ODE5"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ODE", "=", 
   RowBox[{"Flatten", "[", "ODE", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu1", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "1000"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu2", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "1000"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"icode3", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"vu3", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "1000"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode41", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu41", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
      SubscriptBox["csave", "p"]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode42", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu42", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode43", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu43", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"icode44", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"vu44", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode4", "=", 
   RowBox[{"{", 
    RowBox[{"icode41", ",", "icode42", ",", "icode43", ",", "icode44"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"icode4", "=", 
    RowBox[{"Flatten", "[", "icode4", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode51", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu51", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
      SubscriptBox["csave", "n"]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode52", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu52", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode53", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vu53", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"icode54", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"vu54", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icode5", "=", 
   RowBox[{"{", 
    RowBox[{"icode51", ",", "icode52", ",", "icode53", ",", "icode54"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"icode5", "=", 
    RowBox[{"Flatten", "[", "icode5", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icae1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vz1", "[", "i", "]"}], "[", "0", "]"}], "==", 
      SubscriptBox["csave", "p"]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icae2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vz2", "[", "i", "]"}], "[", "0", "]"}], "==", 
      SubscriptBox["csave", "n"]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icae3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vz3", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "4"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icae4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vz4", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0.01"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icae5", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vz5", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
      RowBox[{"-", "0.15"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icae6", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vz6", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
      RowBox[{"-", "0.05"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"icae7", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"vz7", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
       RowBox[{"-", "0.001"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{"{", 
    RowBox[{
    "icode1", ",", "icode2", ",", "icode3", ",", "icode4", ",", "icode5", ",",
      "icae1", ",", "icae2", ",", "icae3", ",", "icae4", ",", "icae5", ",", 
     "icae6", ",", "icae7"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{"Flatten", "[", "ic", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vu1", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vu2", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vu3", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", "u4", ",", "u5", 
     ",", "z1", ",", "z2", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz3", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz4", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz5", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz6", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt2", "+", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"vz7", "[", "i", "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Nt1", "+", "1"}]}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", "=", 
    RowBox[{"Flatten", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Get", " ", "simulation", " ", "time"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calt", "=", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ODE", ",", "AE", ",", "ic"}], "}"}], ",", "var", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "simtime", ",", "0.01"}], "}"}], ",", 
        RowBox[{"AccuracyGoal", "\[Rule]", "4"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
          "}"}]}]}], "]"}]}], ";"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790654553056181*^9, 3.7906546056894484`*^9}, {
   3.7906611604068794`*^9, 3.790661319510172*^9}, {3.7906613672308493`*^9, 
   3.7906614218559523`*^9}, {3.7906630637200117`*^9, 3.790663064735433*^9}, 
   3.7909125913768015`*^9, {3.790912658084349*^9, 3.7909126868234787`*^9}, {
   3.790912722777311*^9, 3.790912732446474*^9}, {3.7909128071706057`*^9, 
   3.7909128556798553`*^9}, {3.7909128920136433`*^9, 3.790912949744231*^9}, {
   3.7909129908532715`*^9, 3.79091306812761*^9}, {3.7909133466599092`*^9, 
   3.7909134679494896`*^9}, {3.790913689322259*^9, 3.790913696782328*^9}, {
   3.790913994314503*^9, 3.790914022710551*^9}, {3.7909142002915373`*^9, 
   3.7909142215706477`*^9}, {3.7909143159641438`*^9, 3.790914349367796*^9}, {
   3.79091446763748*^9, 3.79091450430241*^9}, {3.7909145817741632`*^9, 
   3.790914615947757*^9}, {3.790914687270986*^9, 3.790914715713936*^9}, {
   3.7909147697354164`*^9, 3.790914785724674*^9}, {3.7909148486852436`*^9, 
   3.7909148634068947`*^9}, {3.7909148934784327`*^9, 3.790914988958047*^9}, {
   3.7909150361478543`*^9, 3.7909150459775333`*^9}, {3.790915092340553*^9, 
   3.790915128281393*^9}, {3.790915209816306*^9, 3.7909152491950045`*^9}, {
   3.790915292875146*^9, 3.790915337906723*^9}, {3.790915393632669*^9, 
   3.790915432969453*^9}, 3.790915543678412*^9, {3.790917094983347*^9, 
   3.790917134570486*^9}, {3.7909173111217775`*^9, 3.7909173724234753`*^9}, {
   3.790917625510454*^9, 3.79091767944018*^9}, {3.7909177722484093`*^9, 
   3.7909178354593344`*^9}, {3.790992594548689*^9, 3.7909926683047256`*^9}, 
   3.790992992248295*^9, {3.7909931378612323`*^9, 3.790993199221773*^9}, {
   3.7909932525841947`*^9, 3.790993274056926*^9}, {3.7909934621184254`*^9, 
   3.7909934650864477`*^9}, {3.7909936673314295`*^9, 
   3.7909937754934344`*^9}, {3.7909938667491693`*^9, 
   3.7909939106763463`*^9}, {3.790993965165586*^9, 3.7909939704768357`*^9}, 
   3.7909941188615646`*^9, {3.7909942850585136`*^9, 3.7909942859801707`*^9}, 
   3.790994673395401*^9, {3.7909947267450275`*^9, 3.7909947304628716`*^9}, 
   3.7909948335456176`*^9, {3.7909954731477146`*^9, 3.7909954857697372`*^9}, {
   3.790995905542384*^9, 3.7909960029412727`*^9}, {3.7909960450853996`*^9, 
   3.7909961122883406`*^9}, {3.790996147842433*^9, 3.7909961813657827`*^9}, {
   3.7909963985945654`*^9, 3.790996450488585*^9}, {3.7909965045852118`*^9, 
   3.7909965157856965`*^9}, {3.7909965683580723`*^9, 
   3.7909965716854124`*^9}, {3.790996608524021*^9, 3.7909966169438825`*^9}, {
   3.7909966717590885`*^9, 3.7909967816550646`*^9}, {3.7909969532303596`*^9, 
   3.790997030712098*^9}, {3.7909972180174384`*^9, 3.790997276378652*^9}, 
   3.7909973324675784`*^9, 3.7910854454936852`*^9, {3.7910855258727026`*^9, 
   3.7910855946690164`*^9}, {3.7910860440760603`*^9, 3.791086106561326*^9}, 
   3.791086141724942*^9, {3.7910861958061333`*^9, 3.791086219613022*^9}, {
   3.7910863876802483`*^9, 3.79108660944051*^9}, {3.791086830153286*^9, 
   3.7910869052228146`*^9}, {3.791086990635856*^9, 3.7910870811699004`*^9}, 
   3.7910872883371534`*^9, 3.7911535602506857`*^9, {3.7911539798198524`*^9, 
   3.791154100978829*^9}, {3.7911541312841573`*^9, 3.791154246850669*^9}, {
   3.7911544630264187`*^9, 3.7911544761327057`*^9}, {3.791154575190009*^9, 
   3.7911546471886406`*^9}, {3.7911546857188053`*^9, 
   3.7911546987469826`*^9}, {3.7911547316298294`*^9, 
   3.7911548238268795`*^9}, {3.791862861856818*^9, 3.7918628626806383`*^9}, {
   3.7918631809273167`*^9, 3.791863182916001*^9}, {3.7929727146331744`*^9, 
   3.7929727907558393`*^9}, {3.792972851315793*^9, 3.7929728781581554`*^9}, {
   3.7929729171362534`*^9, 3.792972938443718*^9}, {3.792973431834179*^9, 
   3.792973508753473*^9}, 3.792974559379466*^9, {3.7929747115894423`*^9, 
   3.792974726304715*^9}, {3.792974759109434*^9, 3.7929747846422033`*^9}, {
   3.798257117828905*^9, 3.798257210684365*^9}, {3.798257317638362*^9, 
   3.7982573770561543`*^9}, {3.7982574212908955`*^9, 
   3.7982574580411987`*^9}, {3.7983407277357416`*^9, 3.7983407291788244`*^9}, 
   3.8434306565195527`*^9, {3.843513870703499*^9, 3.843513905889886*^9}, {
   3.843513970948061*^9, 3.843513997808734*^9}, {3.843514062636222*^9, 
   3.843514063737892*^9}},
 CellLabel->
  "In[3118]:=",ExpressionUUID->"27e9d2df-c7b8-4f3d-a6f5-c8bfccd55ce6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"extract", " ", "internal", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tablerey", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sol", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}], "/.", 
        RowBox[{"t", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"10", "*", 
           RowBox[{"(", 
            RowBox[{"Nt1", "+", "1"}], ")"}]}], "+", "Nt2", "+", "1"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"simtime", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tablerez", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sol", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}], "/.", 
        RowBox[{"t", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"10", "*", 
           RowBox[{"(", 
            RowBox[{"Nt1", "+", "1"}], ")"}]}], "+", "Nt2", "+", "1", "+", 
          "1"}], ",", 
         RowBox[{
          RowBox[{"16", "*", 
           RowBox[{"(", 
            RowBox[{"Nt1", "+", "1"}], ")"}]}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"Nt2", "+", "1"}], ")"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"simtime", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Voltage", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outup", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"tablerez", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"Nt1", "+", "1"}], ")"}]}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"Nt1", "+", "1"}], ")"}]}], "+", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"simtime", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outun", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"tablerez", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"4", "*", 
          RowBox[{"(", 
           RowBox[{"Nt1", "+", "1"}], ")"}]}], ",", 
         RowBox[{"4", "*", 
          RowBox[{"(", 
           RowBox[{"Nt1", "+", "1"}], ")"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"simtime", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outup", "=", 
     RowBox[{"Flatten", "[", "outup", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outun", "=", 
     RowBox[{"Flatten", "[", "outun", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outVt", "=", 
     RowBox[{"outup", "-", "outun"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outVt", "=", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"outVt", ",", 
        RowBox[{"simtime", "+", "1"}]}], "]"}], "//", "TableForm"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<paderesult_Vt.csv\>\"", ",", "outVt"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"RMSE", " ", "error", " ", "of", " ", "Voltage"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"comVt", "=", 
     RowBox[{"outVt", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refVt", "=", 
     RowBox[{"Flatten", "[", "refVt", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"comVt", "=", 
     RowBox[{"comVt", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refVt", "=", 
     RowBox[{"refVt", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rmseVt", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"comVt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"refVt", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"simtime", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rmseVt", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Mean", "[", "rmseVt", "]"}], ")"}], "^", "0.5"}], "*", 
      "1000"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7918629063927717`*^9, 3.791863072750019*^9}, {
   3.792972975338369*^9, 3.792973022670562*^9}, {3.798257487207632*^9, 
   3.798257493723281*^9}, {3.7983405141065226`*^9, 3.7983405141345243`*^9}, 
   3.8030354142342415`*^9, {3.84338320927561*^9, 3.8433832362620964`*^9}, {
   3.8435139196876755`*^9, 3.8435139492648506`*^9}, {3.8435140057082014`*^9, 
   3.84351401046703*^9}},
 CellLabel->
  "In[3272]:=",ExpressionUUID->"9e70a5bf-57c5-4074-9f61-55d15e77e7c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"refVt", ",", "comVt"}], "}"}], ",", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{"Red", ",", "Thick", ",", 
        RowBox[{"Opacity", "[", "0.5", "]"}]}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Blue", ",", "Dashed"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Comparsion of Voltage\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"LineLegend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Reference\>\"", ",", "\"\<ASC-I\>\""}], "}"}], ",", 
      RowBox[{"LegendFunction", "\[Rule]", "Frame"}]}], "]"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Time", "[", "s", "]"}], ",", 
      RowBox[{"Voltage", "[", "V", "]"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8434306713970366`*^9, 3.8434306718344345`*^9}, {
  3.8435141620896063`*^9, 3.8435141650391006`*^9}},
 CellLabel->
  "In[3287]:=",ExpressionUUID->"bb92e9d2-edbe-4806-8d43-ecfadb580798"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[1, 0, 0], 
         Thickness[Large], 
         Opacity[0.5]], 
        LineBox[CompressedData["
1:eJw1knk4lXkfh2XJGZVETQtlmSSSXdb0kV122R2Ocxz7IJmWSdIiL1mqkSRF
Ukq0UFrQ61WjJkZRtEw4TPUiU00jkSnTe72/73Ndv+t33c/nup/7n0eVn+Al
FBcTE3v69fzv/v/zbk1KRo2a3o5ZYC+QVFE+NNeVmIMUZ4mUWVrEcigqqzyr
K0s8F7IN626VjM1kvABWbZy6F/3ESvjxaUmAy31iFZzaH3acd5NYDXnDilEn
zxMvRc0L7fnDJcTLEMndWKV1kHg59mxbYaiaTqwFK35pz+UtxNr4U/rtcHcc
sQ5c6gI27goj1sO1QuvKQl9ifeR8vCil4UJsgIIST5tX1sSG+Lxzsk3JlNgI
+eo7SnJ0iI1xOP/siLE68SoMZDiqWSgRm0Ahd59ehAKxKSqbjezvyRCbYQ78
9WLFic2RPrY0b8WnGYwtMPEyo2zpe2JLBHY9qrQdJl4N+Swd1R0DxFZ4MiFo
e/eMeA3KITm69SExMHZ7h6ZyG+M04Eh38/Q/btNujY0JgZ/bGmm3xpcHklb3
6mhfi8pOk5f9F2hfiybFFWGcs7TbIONlXI5zGe02yBbUqBcfpd0We/8+MDqR
T7stsrdOLYrPpd0O3ykt7hjKoN0OB/SmVibupN0eiXPaudO20W4P4enLXwqS
aXfAvPyipYbxtDtgya+rCzoiaXfE+bMtGhvCaHfEuKf7fLkg2p3wuO+BoHo9
7U7oT/xptpMb7c5YbGBm0+tAuzOcG7RuJFjTvg6H5w/JTZrTvg7/9ksJTjWi
3QXSZr8pfl5JuwscH5Q3JGnQ7orlZVvG+1Rod0Vr1RW+3SLa3XA00O2vMgXa
3WC/sv/Ax5m0u+PHiGcDmE67O6aanijvnJJhuwemiRpCro0zhgcKZhude/Un
4zQP+FQfH+O8ZtzkgfRTBTeUX5DviSQzl+PaPeR7Ymo2xPW6yfcEv1tvUPM+
+Z74/a7p7nl3yfdC0S3L1rEm8r3QJlPj236dfC9whRIJxTXke2HDROm6kHPk
e2NfjvVG+XLyvTFDvGGooZh8b3wq7GvnHiLfGxYd0/aN5pC/HvzWV+Lb9pK/
Hjlch/+Mp5K/Ht/OiKyM20z+esjd2vqlK4F8H5ilZvcZRJHvg6vmX0S7eeT7
4P371w33/Mn3gUAho1vSk3xf1H2ovmboRL4vDNpn3/S3Jt8XygHP/JPMyPdF
gGjukjR98v0Qc+EXud2a5PtBpcWVs02VfD9M8/bziVxIvh++5RTucJxDvj+W
BfW2L/mGfH9klsg6D4mR7w8J78y8M+PfMN8ftS3DpcHvGIsFQNVtQ4TUIGME
4J4aZ7Csj3FaAKw+XFUxfkx+ABYL4yQb2skPxGoNlSKTFvIDMW//9ecVjeQH
wsJHr3HmFfIDYaJ2HBFV5Afh4k/rPtWeJD8Iup83dX4oIj8IbxMtjLQPkh8E
Cfs2Tb9M8oNRVRtvuymN/GCc6Vx2PXMz+cFQTW3pOBBPfjAwZ+GtHCH5XEx2
mKqkBpPPBV/5tZPAm3wu/lsoX2ThTD4X33fdSJG2Jj8EcqlR5r+YkB+CzoEz
ddt1yA9Bvkz9THV18kPwsMD0TpMi+aGQLu465i5Pfiiet1rJdnDID4XAOMjN
aYrD/FCIKqSyaj8wFuPBqOxFouwIYxUecoO5caEDjMHD9qnO/rInjHk8ZIco
G3a3M07j4U1LtLrYz4xLeahLMPhVsZ56PJTrf3q0/BJjEQ+HYwePa1ZQPwyi
ZR3iSseoH4bWmcvzpg5SPwzlbwpHu/9F/TAs279HriSV+mHQrq+wC0imfhh+
UJGekoyhfhiKnxWqnwilfhhOd3vm6vpQnw/XBcnyF5ypz4dIrCxFEdTno8A8
MyPVmPp8lP2h9Nd9Lerzcelkr62sCvX5mNWd7GAzj/p8+N8Z+ztEhvp8rPDr
ad4wJc36AnCkzT4mjjJWEcDC9OFAyBBjCL7+zwpnzHsZ8wQIXvv2hNRDxmkC
qHK4F2/eYVwqwN8ft2UJGxg3CcB3WyGauMhYJEDtTRPLjaeoH45PkvyEwSPU
D0fJ7exDq3OpHw5L8bxnWbuoHw794pEFVzdRPxz77NXln8RQPxxV+aNDvSHU
D8eh3b2NHV7UD8epWs2eS/bUF2J7nkFBsjn1hYiruXZQW4f6Quzac5nTqEp9
IRyXK6y2nUd9IcqbrxpVcKgvxEi97NyJyemsL8RA9pFxnbeMRUJc7dF44zjA
WCwC1cMPnrt3MVaJwOa0BeK6dxkjAjJVj9Ml6hnzIiB5YkvS6WrGaRHoX4NY
y1LGpRGQ7a+rP3uQ+hEovtbj/HkP9SNwqvO2ncFm6keisENRD9HUj4R3ps0i
iyDqR8LRaw1vyoX6kUhvFg5fsaJ+JBqTy2z09agfibXxLasOq1I/EgvNNxy+
L0/9SNRHHzP4XYL6UdBw5f7WPSrF+lHIyhGaZb1kjCg8flttodbNmBeF53O4
q/a1ME6LQrR977vGOsalUXBV1vnYcZpxUxTe10weOlrAWBSFRrun9ZZ7GYtF
43u58DV1P1A/GtIBh1pfhVM/GrnWM3T7vKkfjfPndFeVrqX+V9/25yQtfepH
w33/Q2OhMvWjsXsk/kvwLOpHw7dGebrCpCTrx8Bju/ZI+iBjlRgY6Vsbnu5i
jBiERH+nGNvMmBeD9zzxEdF5xmkxMHzsIS11lHFpDPpvNy5+tJdxUwwelEl3
qyUxFn39/hOT8tlc6sdiyZ5NMgUO1I9F7sQrtUv6kvgHWfCKTQ==
         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[0, 0, 1], 
         Dashing[{Small, Small}]], 
        LineBox[CompressedData["
1:eJw1jQk01Wkfx+8rImkoqktMtCCiRoul6FsIUXHt+13c696rQTXSpldFSCm7
mumlkkpESEYlVFpGu2mZqSyFCa8kU0qvmd4zz+8553+e8/l/n8/5GAijeGIF
Dofz7Ov3//ufM7Ds2JuhFU93TgD7gRpFvnaKG7EKdu6uld81JdbAJQvZ+9aJ
xFpY9qniTeiIGmMuUpKDO027iXWx33/J29oWYn2cfPlya81V4hnYfTO1v7uS
eBYGutzLdU4QG4KXF15lmktsjJyIrs9fUohNEHN0Tl9MHPFcGF3SMtm1ntgc
e714FzQkxPPBiXrsrBlI/B0ar0y6GedObIHLB152Oq4kXoDuB9vvCZcSL4TB
xAuvmy2IF+HM6NW0uDnEi5HwRKYQpU9siQijqqU/TSW2wsDsK2UcdWJr5CTN
TcobS2yDdA+t4dDR8YyXwLV7eLHXB+Kl2KY5ULy+n9gWBZrZV6u7iO2wY5LT
4umtxMtwzPaGxpknxMDi8Q5bfO4zjgeGDdWM9G/RvhxWL0tOKjXSvhx/uaYe
VbpI+wp8aE/t0quifQXCTsWquZXSbo87DZaZB4pot8c36f893ZlPuwN2nUrL
dztEuwOmSs8kN2bQ7og46UKB4z7aHTHAVdV4lEj7Sty32hAt+zftK6Fw86bV
2C20O6F3mj335AbancDN0C5yWUe7M7LXzZf2iml3xtiANx0pobS7wMhZJ3eG
P+0uWLXdZEolj/ZVcNi/doK1G+2r4Dx43KvCkXZX2OzmK+gto90V/Veb4mKt
aHdDWe2svfXf0e4GudYD/48mtK/GRPVNOdNm0b4a/pX7As30aF8Dy0lvYTaF
9jXYrfxuta467Wvhe//N4xFl2tdi+W+C9Dsc2t1h2urPy/yk+g/DHTq8rNE1
g4zj3dH7c3KVQi/jenfs8R5jXP6KMccDPumnk/yfk++BqCXq1/9qId8DLeYH
+wrvkO+B/fnRnS5N5PPw7ThO2ts68nmoi19QknOBfB4Kwgx+WVZOPg/+Hp80
ek+R74lbndzKvKPke+KjYKDY+TD5nvBxsin4nEG+J9Tjl9udTSXfCzYX9k0T
JZDvheOlyQe4ceR7oUvP4vmdGPK9YCgunLsrknxvVGTdTFgYTr430vK97r4K
Jd8bJc6ce2l+5HvD4Nn9eQs9yPfB5cPVmx+6kO8Dz6AGTekK8n1Q5Llw7Xsb
8n1wsy8/dMMC8n1hezQ9/JUp+b7gtwZsd5hFvi8OlqqVZeqS7wtziyGde1rk
+2FWRUTnkBr5fvDS/543Rol8P7gnHn48/GUc8/1w7V/Gei1DjDn+CE16NS2r
jzH88XyhiarVa8bx/pj7x+DmK7+T7w+7VnmIySPyAxBXWDF/y23yA5AzanC2
pIH8AJgJH3ZcryE/AM3rPyo0lZEfiGrLB+1ni8gPRBICj+06Qn4gzCbb2dln
kR8IW53pOwb3kh+E9NcT72bsJD8ISad/P2G4mfwgFPoJ1MsiyQ9CUHLTRXMx
+cHo095woyiQ/GBYXy7P5fLID8a29kvRic7kByMvOlqn3478EDhrSxQ9F5Ef
gg7VyuIqU/JDsGG+nq3mDPJDkLt8o1Mkl/xQzPtTt+f6N+SHQt9LKtFWIj8U
/xOFLpGOqDA/FCOuoq5z7xhz+KiSZB74s5uxPh9aZekZFi8Zg48p7zmrpC2M
+XxIW3ras28zjucjgRf1vLaecQEfuy2imx5XU4+PLPtPs9+UMG7j47DDtcvv
jlFfgP0/BokG8qgvQL+xvXZnGvUFmHldb/ReAvUFUL8fuubcVuoLYPApTZIS
TX0BDvtaV/tJqC9AZGZI3fQg6gvQk3lEudWD+kIs2ldnlutEfSHWyMJKnW2p
L4SS1XKlIQvqf33fLDtyyJj6QmhlT22w/pb6Qgx2jMlu0aS+EM+47lz5OOoL
cdy2XvPzqDLri6Cdd8gkYYixvgibesoalXsYQwSjdG+1hFbGfBE6b8wbP9zC
OF6EOamJicLbjAtE4J+eOr3xCuN6EWraBSsnn2fcJkLz3HrHgGLqh6Ej95D7
gXzqh0H3zvc7K7KoH4ZjylsVGlOo//V9vF7bxR3UD0NZSH7/kY3UD0NszYWT
Ein1w5CQWx6pFUz9MPR036g84UF9Mb6UW9dyV1JfjD1Fde8ibKgvxoJVk2bm
m1NfjB6nuuqKGdQXY62wZ+uJKdQX4/yL7fIfVKkvxu1UDn/G6FjWF6P4XGJ2
+TvGHAksBq9O0+1krC/BqfOxHeFPGUOCmIcLdDN+YcyXICzPueJIHeN4Ccbd
zT+fco5xgQQSvsomr0LG9RKI85T0FXOpL4HbnBj5wRTqhyNq8qcvo9uoH47a
a80vXCOpH472W801m/jUD8e3bTmW8Tzqh+Mn2dtIoQP1w3GxdNw1vcXUD0dl
5Yf5Z42oHw5ET6jW0Ka+FFCRdUGV+lK4NLhX2Ywosb4Unb825g/3MuZLMaVw
BDHPGcdLsSM7nVfczLhAChWzmdz0S4zrpfhPjPbeGSWM26QQjm/o9fmRMUcG
41IjS8O9jPVl2LVxjGryZurLYJbg9XCjhPoy6HbYvmjzpL4MyYr1e5pAfRl+
mHTSU9eM+jLIB5+Y/8alvgzWTxsTh8dQX47CkLB10f2KrC+H273Y1iVPGUMO
5YmJN7wbGPPlKJKp/PrzacbxciTlBxuI0xkXyGGY90jkvZlxvRxmyywnJocw
bpMjofZE3xd7xpwIvIidPbvCmPoR+GNR191CNUX8DbPlicw=
         "]]}}, {{
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[1, 0, 0], 
         Thickness[Large], 
         Opacity[0.5]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[0, 0, 1], 
         Dashing[{Small, Small}]]}}, {{
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[1, 0, 0], 
         Thickness[Large], 
         Opacity[0.5]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[0, 0, 1], 
         Dashing[{Small, Small}]]}, {}, {}, {}}, {{
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[1, 0, 0], 
         Thickness[Large], 
         Opacity[0.5]]}, {
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         AbsoluteThickness[1.6], 
         RGBColor[0, 0, 1], 
         Dashing[{Small, Small}]]}, {}, {}, {}}}, {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {
       FormBox[
        RowBox[{"Time", "(", "s", ")"}], TraditionalForm], 
       FormBox[
        RowBox[{"Voltage", "(", "V", ")"}], TraditionalForm]}, 
     AxesOrigin -> {0., 2.44049444137731}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> 
     FormBox["\"Comparsion of Voltage\"", TraditionalForm], 
     PlotRange -> {{0., 217.}, {2.44049444137731, 3.6884007674209025`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"Reference\"", "\"ASC-I\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        FrameBox[
         StyleBox[
          StyleBox[
           PaneBox[
            TagBox[
             GridBox[{{
                TagBox[
                 GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0], 
                    Thickness[Large], 
                    Opacity[0.5]], {
                    LineBox[{{0, 10}, {40, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0], 
                    Thickness[Large], 
                    Opacity[0.5]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {40, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1], 
                    Dashing[{Small, Small}]], {
                    LineBox[{{0, 10}, {40, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 0, 1], 
                    Dashing[{Small, Small}]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {40, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                  GridBoxAlignment -> {
                   "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                  AutoDelete -> False, 
                  GridBoxDividers -> {
                   "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                  GridBoxItemSize -> {
                   "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                  GridBoxSpacings -> {
                   "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
              GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
              AutoDelete -> False, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
             "Grid"], Alignment -> Left, AppearanceElements -> None, 
            ImageSizeAction -> "ResizeToFit"], LineIndent -> 0, StripOnInput -> 
           False], {FontFamily -> "Arial"}, StripOnInput -> False], 
         Background -> Automatic, RoundingRadius -> 5, ContentPadding -> True,
          FrameMargins -> {{5, 5}, {5, 5}}, FrameStyle -> Thickness[0.01], 
         StripOnInput -> False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0, 0], Editable -> False, Selectable -> 
                    False], ",", 
                   RowBox[{"Thickness", "[", "Large", "]"}], ",", 
                   RowBox[{"Opacity", "[", "0.5`", "]"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 0, 1], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0., 0., 0.6666666666666666], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 0, 1], Editable -> False, Selectable -> 
                    False], ",", 
                   RowBox[{"Dashing", "[", 
                    RowBox[{"{", 
                    RowBox[{"Small", ",", "Small"}], "}"}], "]"}]}], "]"}]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendFunction", "\[Rule]", "Frame"}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.8434306823764505`*^9, 3.843514018166109*^9, 3.8435140806278276`*^9, {
   3.843514151073547*^9, 3.843514170903906*^9}},
 CellLabel->
  "Out[3287]=",ExpressionUUID->"36033edf-1959-4bda-aa04-b84c9c1663b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Show", " ", "simulation", " ", "time", " ", "and", " ", "RMSE", " ", "of",
     " ", "voltage"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"calt", "        ", 
   RowBox[{"(*", 
    RowBox[{"Simulation", " ", "time", " ", 
     RowBox[{"(", "s", ")"}]}], "*)"}], "\[IndentingNewLine]", "rmseVt", 
   "   ", 
   RowBox[{"(*", 
    RowBox[{"RMSE", " ", "of", " ", "voltage", " ", 
     RowBox[{"(", "mV", ")"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8435140296528625`*^9, 3.8435140468357625`*^9}, {
  3.8435140846223164`*^9, 3.8435141426896844`*^9}},
 CellLabel->
  "In[3288]:=",ExpressionUUID->"0dfbad53-3cf4-4be6-8c46-e818b03918b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.843514094267623*^9, {3.843514151147689*^9, 3.843514170975662*^9}},
 CellLabel->
  "Out[3288]=",ExpressionUUID->"8ebc4c1f-c2b3-4571-b5ae-2884555b3be4"],

Cell[BoxData["4.578928202045835`"], "Output",
 CellChangeTimes->{
  3.843514094267623*^9, {3.843514151147689*^9, 3.843514170979621*^9}},
 CellLabel->
  "Out[3289]=",ExpressionUUID->"22049f74-13cf-418d-86d8-4f406a5864b8"]
}, Open  ]]
},
WindowSize->{807, 632},
WindowMargins->{{Automatic, 361}, {Automatic, 173}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (2019\:5e744\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 14296, 348, 1588, "Input",ExpressionUUID->"027b302b-87cb-4a88-9c4e-e0a877a08b14"],
Cell[14857, 370, 3152, 85, 219, "Input",ExpressionUUID->"69a31226-a7f4-407c-9ff8-638fea1358a8"],
Cell[18012, 457, 32818, 967, 3971, "Input",ExpressionUUID->"889742f7-ba98-4d77-9b0b-a5f3a41feb3a"],
Cell[50833, 1426, 10450, 290, 1313, "Input",ExpressionUUID->"bc0842f9-5137-423c-b5fe-fc5d9faf653b"],
Cell[61286, 1718, 685, 19, 124, "Input",ExpressionUUID->"835397eb-71fb-41ea-a128-68be5ad0ddb1"],
Cell[61974, 1739, 1131, 28, 121, "Input",ExpressionUUID->"9721a7cf-3680-41dc-8536-7385d55890ca"],
Cell[63108, 1769, 7840, 233, 526, "Input",ExpressionUUID->"f1794da6-d8b9-448f-aa37-a304fd2ae79d"],
Cell[70951, 2004, 6878, 161, 436, "Input",ExpressionUUID->"2a73444e-84ac-4f82-9ab3-d7c439abee3a"],
Cell[77832, 2167, 4331, 138, 411, "Input",ExpressionUUID->"3550f974-7a27-4bfd-8203-f364723fc6f5"],
Cell[82166, 2307, 10445, 321, 942, "Input",ExpressionUUID->"5cc7872b-f089-489a-bb5c-b28351d612b2"],
Cell[92614, 2630, 141750, 4122, 14175, "Input",ExpressionUUID->"27e9d2df-c7b8-4f3d-a6f5-c8bfccd55ce6"],
Cell[234367, 6754, 6175, 176, 816, "Input",ExpressionUUID->"9e70a5bf-57c5-4074-9f61-55d15e77e7c9"],
Cell[CellGroupData[{
Cell[240567, 6934, 1134, 28, 193, "Input",ExpressionUUID->"bb92e9d2-edbe-4806-8d43-ecfadb580798"],
Cell[241704, 6964, 19458, 408, 243, "Output",ExpressionUUID->"36033edf-1959-4bda-aa04-b84c9c1663b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261199, 7377, 698, 17, 67, "Input",ExpressionUUID->"0dfbad53-3cf4-4be6-8c46-e818b03918b6"],
Cell[261900, 7396, 254, 6, 32, "Output",ExpressionUUID->"8ebc4c1f-c2b3-4571-b5ae-2884555b3be4"],
Cell[262157, 7404, 220, 4, 32, "Output",ExpressionUUID->"22049f74-13cf-418d-86d8-4f406a5864b8"]
}, Open  ]]
}
]
*)

